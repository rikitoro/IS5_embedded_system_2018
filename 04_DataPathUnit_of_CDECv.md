# CDECvのデータパス部の構成と動作

本章ではCDECvのデータパス部の回路構成について説明します。
また、制御部から送られてくる制御信号によって、データバス部の動作がどのように制御されるのかを確認します。

## データパス部の構成

CDECvのデータパス部の全体構成を図4.1に示します。
図4.1ではデータをやり取りするデータ線のみを示しており、制御信号やクロックなどの信号線は省略しています。

CDECvのデータパス部の特徴は、1本の8ビットのデータバスXbusを中心として構成されている点です。
このXbusを介して、データのやり取りが行われます。

データパス部には、プログラムカウンタ(PC)、汎用レジスタ(A, B, C)、フラグレジスタ(FLG)からなるレジスタセットとメモリ(256Byte)が含まれます。
さらに、算術論理演算を行うためのALUと、レジスタセット以外の各種レジスタが含まれています。

ALUには2章で説明した図2.8に示したものを利用します。
このALUは4ビットの制御信号により表2.5のように様々な演算機能を切り替えることができます。

レジスタセット以外のレジスタとしては、WDR(Write Data Register)、MAR(Memory Address Register)、T(Temporary register)、R(Result register)、I(Instruction register)があります。これらはすべて8ビットのレジスタです。
このうち、WDRはメモリへの書き込みデータ、MARはメモリのアドレス指定を保持するためのレジスタです。
TレジスタはALUで2項演算を行う際に一方の演算対象を格納するための用いられます(もう一方の演算対象はXbusから読みだされます)。
RレジスタはALUで実行された演算結果を保持するレジスタです。
Iレジスタは機械語命令の先頭バイトを格納するレジスタで、実行中の機械語命令の情報を制御部へ伝達します。

![CDECvデータパス部の構成](./assets/datapath_sketch.png "CDECvデータパス部の構成")

<図4.1 CDECvデータパス部の構成>


## Xbusを介したデータ転送

![転送元レジスタの選択回路](./assets/xsrc.png "転送元レジスタの選択回路")

<図4.2 データ転送元の選択回路>


![転送先レジスタの選択回路](./assets/xdst.png "転送先レジスタの選択回路")

<図4.3 データ転送先レジスタの選択回路>


![メモリへのアクセス回路](./assets/MEMwe.png "メモリアクセス回路")

<図4.4 メモリへのアクセス回路>


![ALU制御回路](./assets/aluop.png "ALU制御回路")

<図4.5 ALUの制御回路>


![制御部への信号](./assets/I_SZCy.png "制御部への信号")

<図4.6 制御部への信号>
